# 钱包连接需求文档

## 1. 项目概述

### 1.1. 项目目标

本项目的核心目标是为Web应用程序开发一个健壮且用户友好的模块，允许用户连接他们的以太坊兼容钱包。该模块将负责显示基本的钱包信息（如地址、余额、网络状态）并管理连接状态。它将作为任何需要与钱包进行交互的去中心化应用（dApp）的基础组件。

### 1.2. 目标用户

本模块的目标用户是需要与区块链进行交互、进行身份验证或证明资产所有权的DApp使用者。

## 2. 功能需求

### 2.1. 钱包连接

- **“连接钱包”按钮**：用户界面（UI）必须提供一个清晰可见的“连接钱包”按钮。
- **钱包选择模态框**：点击该按钮后，应触发RainbowKit模态框，向用户展示一个支持的钱包列表（例如：MetaMask, WalletConnect, Coinbase Wallet）。
- **连接状态管理**：
    - 成功连接后，“连接钱包”按钮应被替换为一个显示用户钱包信息的元素（例如，截断后的钱包地址）。
    - 应用程序必须持久化连接状态，确保用户在刷新页面后仍保持连接。

### 2.2. 钱包信息展示

- **连接成功后的UI**：当钱包连接成功时，UI应展示以下信息：
    - 用户的公开钱包地址（为了更好的显示效果，可使用截断版本，如 `0x1234...5678`）。
    - 钱包当前连接的网络（例如：“以太坊主网”、“Sepolia测试网”）。
    - 用户在当前网络上的原生代币余额（例如：ETH）。
- **动态更新**：如果用户在他们的钱包应用内切换了账户或网络，UI上显示的信息应自动更新。

### 2.3. 钱包断开连接

- **断开连接功能**：点击已连接的钱包地址/信息区域，应弹出一个包含“断开连接”按钮的菜单或视图。用户点击该按钮即可安全断开钱包。
- **状态重置**：断开连接后，应用程序的状态应重置为初始的未连接状态，并清除所有相关的会话信息。

## 3. 非功能性需求

### 3.1. 技术栈

- **框架**：**Next.js** (使用App Router以利用其现代化的React特性和服务器端渲染能力)。
- **语言**：**TypeScript**，以确保类型安全并提升开发体验。
- **Web3库**：
    - **Wagmi**：一个用于以太坊的React Hooks集合，用于管理钱包数据的状态。
    - **Viem**：一个轻量级、高效的以太坊TypeScript接口，作为Wagmi的底层库，用于与区块链交互。
    - **RainbowKit**：一个React库，提供美观且可定制的钱包连接体验。
- **区块链通信**：
    - 所有与以太坊区块链的通信将通过一个**Infura RPC URL**进行。此URL必须作为安全的环境变量进行管理。
- **样式**：项目将采用 **Tailwind CSS** 进行样式开发。其“utility-first”的原子化类名方法能够与Next.js和RainbowKit无缝集成，实现高效、一致的UI开发。

### 3.2. 用户体验 (UX)

- **直观流程**：从点击“连接”到查看钱包详情的整个过程应无缝衔接，力求最少化用户操作。
- **状态反馈**：应用程序必须为所有状态提供清晰的视觉反馈：加载中、连接成功、连接失败、网络切换等。
- **响应式设计**：所有UI组件必须完全响应式，在桌面和移动设备上都能正常工作。

### 3.3. 安全性

- **非托管**：本应用程序绝不会接触或存储用户的私钥。所有的交易和消息签名都将委托给用户的钱包提供商处理。
- **安全配置**：Infura的API密钥和RPC URL必须存储在环境变量（`.env.local`）中，严禁在客户端暴露。

## 4. 范围之外

本阶段项目严格限制在以下范围内，不包含：

- 智能合约的交互实现（无论是读取还是写入）。
- 发送交易的功能。
- 与钱包地址绑定的后端用户认证系统。
- 超出`wagmi`为钱包数据提供的范围之外的复杂状态管理。