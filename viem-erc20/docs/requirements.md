# Viem ERC20 操作需求文档

本文档详细描述了使用 Viem 与 ERC20 代币（地址：0xa7d726B7F1085F943056C2fB91abE0204eC6d6DA）交互的需求。

## 1. 功能需求

### 1.1 账户转账

- **需求**：实现向指定账户地址转账的功能。
- **操作**：
    - 连接到以太坊网络。
    - 使用私钥或助记词解锁发送方账户。
    - 构建并发送交易，指定接收方地址和转账金额。
    - 等待交易确认并获取交易回执。

### 1.2 读取 ERC20 合约信息

- **需求**：从 ERC20 合约中读取以下数据：
    - 合约发行方（Owner）
    - 指定地址的持币数量（Balance）
    - 每个地址的持币上限（Cap per address）
    - 总发行量（Total Supply）
- **操作**：
    - **合约发行方**：调用合约的 `owner()` 或类似函数。
    - **地址持币数量**：调用 `balanceOf(address)` 函数，传入要查询的地址。
    - **持币上限**：查询合约中与持币上限相关的状态变量或函数（具体实现取决于合约）。
    - **总发行量**：调用 `totalSupply()` 函数。

### 1.3 Mint ERC20 代币

- **需求**：为自己的账户铸造（Mint）新的 ERC20 代币。
- **限制**：单次铸造数量不超过 10,000 枚。
- **操作**：
    - 调用合约的 `mint(address to, uint256 amount)` 或类似写函数。
    - `to` 参数设置为自己的账户地址。
    - `amount` 参数设置为期望铸造的数量（不超过 10,000）。
    - 发送交易并等待确认。

### 1.4 查询铸造后的余额

- **需求**：在铸造操作完成后，查询并确认自己账户的 ERC20 代币余额。
- **操作**：
    - 待 `mint` 交易确认后，再次调用 `balanceOf(address)` 函数。
    - 传入自己的账户地址，获取更新后的余额。
    - 验证余额是否与预期一致。

### 1.5 错误处理与用户体验

- **需求**：为所有 Web3 操作提供完善的错误处理和用户友好的反馈机制。
- **错误类型覆盖**：
    - **用户拒绝交易**：当用户在钱包中取消交易时，显示友好提示。
    - **余额不足**：当账户 ETH 余额不足以支付 Gas 费用时，提供明确说明。
    - **网络错误**：处理 RPC 连接失败、网络超时等问题。
    - **合约执行失败**：处理智能合约执行被拒绝的情况。
    - **权限错误**：处理用户无权限执行特定操作的情况。
    - **输入验证错误**：处理无效地址、无效金额等输入错误。
- **用户反馈机制**：
    - **Toast 通知系统**：为成功、警告、错误操作提供实时通知。
    - **状态指示器**：显示交易进行中、成功、失败等状态。
    - **错误消息格式化**：将技术性错误转换为用户易懂的描述。
    - **操作建议**：为每种错误类型提供相应的解决建议。
- **操作**：
    - 实现统一的错误识别和分类系统。
    - 为每种错误类型提供用户友好的消息和建议。
    - 集成 Toast 通知系统，实时显示操作结果。
    - 在交易失败后自动清理状态，允许用户重试。

## 2. 技术栈

- **核心库**：[Viem](https://viem.sh/)
- **目标合约**：ERC20
- **合约地址**：`0xa7d726B7F1085F943056C2fB91abE0204eC6d6DA`

## 3. 环境要求

- **Node.js**: >=18.x
- **pnpm/npm/yarn**: 最新版本
- **钱包**：需要一个包含私钥或助记词的以太坊钱包，用于签名交易。
- **RPC 提供商**：需要一个有效的以太坊节点 RPC URL，用于与区块链交互。